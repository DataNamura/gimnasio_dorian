---
import { FaBars } from 'react-icons/fa';
import { FaTimes } from 'react-icons/fa';

// Obtener la ruta actual
const currentPath = Astro.url.pathname;
const isHomePage = currentPath === '/';
const baseUrl = isHomePage ? '' : '/';
---

<header class="fixed w-full top-0 z-50 bg-black border-b border-white/5">
    <div class="container mx-auto px-4">
        <nav class="flex items-center justify-between h-20">
            <!-- Logo -->
            <a href={baseUrl} class="text-2xl font-bold">
                <span class="text-gym-red">DORIAN</span>
            </a>

            <!-- Menú Desktop -->
            <div class="hidden md:flex items-center space-x-8">
                <a href={`${baseUrl}#hero`} class="text-white hover:text-gym-red transition-colors duration-300">Inicio</a>
                <a href={`${baseUrl}#nosotros`} class="text-white hover:text-gym-red transition-colors duration-300">Nosotros</a>
                <a href={`${baseUrl}#instalaciones`} class="text-white hover:text-gym-red transition-colors duration-300">Instalaciones</a>
                <a href={`${baseUrl}#entrenadores`} class="text-white hover:text-gym-red transition-colors duration-300">Entrenadores</a>
                <a href={`${baseUrl}#precios`} class="text-white hover:text-gym-red transition-colors duration-300">Precios</a>
                <a href={`${baseUrl}#contacto`} class="text-white hover:text-gym-red transition-colors duration-300">Contacto</a>
            </div>

            <!-- Botón Menú Móvil -->
            <button id="menu-btn" class="md:hidden text-white text-2xl">
                <FaBars />
            </button>
        </nav>
    </div>

    <!-- Menú Móvil -->
    <div id="mobile-menu" class="fixed inset-0 bg-black/95 backdrop-blur-lg transform translate-x-full transition-transform duration-300 md:hidden">
        <div class="container mx-auto px-4 py-8">
            <div class="flex justify-end mb-8">
                <button id="close-menu" class="text-white text-2xl">
                    <FaTimes />
                </button>
            </div>
            <div class="flex flex-col items-center space-y-6">
                <a href={`${baseUrl}#hero`} class="text-white text-xl hover:text-gym-red transition-colors duration-300">Inicio</a>
                <a href={`${baseUrl}#nosotros`} class="text-white text-xl hover:text-gym-red transition-colors duration-300">Nosotros</a>
                <a href={`${baseUrl}#instalaciones`} class="text-white text-xl hover:text-gym-red transition-colors duration-300">Instalaciones</a>
                <a href={`${baseUrl}#entrenadores`} class="text-white text-xl hover:text-gym-red transition-colors duration-300">Entrenadores</a>
                <a href={`${baseUrl}#precios`} class="text-white text-xl hover:text-gym-red transition-colors duration-300">Precios</a>
                <a href={`${baseUrl}#contacto`} class="text-white text-xl hover:text-gym-red transition-colors duration-300">Contacto</a>
            </div>
        </div>
    </div>
</header>

<script>
    // Menú móvil
    const menuBtn = document.querySelector('#menu-btn');
    const closeBtn = document.querySelector('#close-menu');
    const mobileMenu = document.querySelector('#mobile-menu');
    const mobileLinks = document.querySelectorAll('#mobile-menu a');

    menuBtn?.addEventListener('click', () => {
        mobileMenu?.classList.remove('translate-x-full');
        document.body.style.overflow = 'hidden';
    });

    const closeMenu = () => {
        mobileMenu?.classList.add('translate-x-full');
        document.body.style.overflow = '';
    };

    closeBtn?.addEventListener('click', closeMenu);
    mobileLinks.forEach(link => {
        link.addEventListener('click', closeMenu);
    });

    // Scroll suave
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(this: HTMLAnchorElement, e: Event) {
            e.preventDefault();
            const href = this.getAttribute('href');
            if (!href) return;
            
            const target = document.querySelector(href);
            if (!target) return;

            const headerOffset = 80;
            const elementPosition = target.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        });
    });

    // Resaltar sección activa
    const sections = document.querySelectorAll<HTMLElement>('section[id]');
    const navLinks = document.querySelectorAll<HTMLAnchorElement>('header nav a');

    window.addEventListener('scroll', () => {
        let current = '';
        const headerHeight = 80;

        sections.forEach(section => {
            const sectionTop = section.offsetTop - headerHeight - 100;
            const sectionHeight = section.offsetHeight;
            if (window.scrollY >= sectionTop && window.scrollY < sectionTop + sectionHeight) {
                current = '#' + section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('text-gym-red');
            if (link.getAttribute('href') === current) {
                link.classList.add('text-gym-red');
            }
        });
    });
</script>

<style>
    header {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
</style>
